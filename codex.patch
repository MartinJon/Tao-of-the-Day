diff --git a/lib/menu_dialogs.dart b/lib/menu_dialogs.dart
index cfe2ba24b383f0b644c2c625abbd58f9a6695f60..0d3406bd43bc9bee079e4e075bcb968f3658eb4e 100644
--- a/lib/menu_dialogs.dart
+++ b/lib/menu_dialogs.dart
@@ -1,36 +1,100 @@
+import 'package:flutter/foundation.dart';
 import 'package:flutter/material.dart';
 import 'package:intl/intl.dart';
-import 'package:url_launcher/url_launcher.dart';
 import 'package:package_info_plus/package_info_plus.dart';
-import 'package:shared_preferences/shared_preferences.dart';
-import 'services/subscription_service.dart';
+import 'package:url_launcher/url_launcher.dart';
+
 import 'pages/subscription_page.dart';
+import 'services/subscription_service.dart';
 import '../services/trial_service.dart';
 
+class _MenuDialogPalette {
+  final Color primary;
+  final Color background;
+  final Color body;
+
+  const _MenuDialogPalette({
+    required this.primary,
+    required this.background,
+    required this.body,
+  });
+
+  factory _MenuDialogPalette.from(BuildContext context) {
+    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
+    return _MenuDialogPalette(
+      primary: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00),
+      background: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+      body: isDarkMode ? Colors.white70 : Colors.black87,
+    );
+  }
+}
+
 class MenuDialogs {
-  static const String appVersion = '1.0.0';
+  static const String _fallbackAppVersion = '1.0.1+65';
+  static final Future<String> _appVersionFuture = _loadAppVersion();
+
+  static Future<String> _loadAppVersion() async {
+    try {
+      final packageInfo = await PackageInfo.fromPlatform();
+      final buildNumber = packageInfo.buildNumber.trim();
+      return buildNumber.isNotEmpty
+          ? '${packageInfo.version}+$buildNumber'
+          : packageInfo.version;
+    } catch (error, stackTrace) {
+      debugPrint('Failed to read package info: $error');
+      debugPrintStack(stackTrace: stackTrace);
+      return _fallbackAppVersion;
+    }
+  }
+
+  static List<Widget> _defaultActions(BuildContext context) {
+    return [
+      TextButton(
+        onPressed: () => Navigator.pop(context),
+        child: const Text('Close'),
+      ),
+    ];
+  }
+
+  static Future<void> _launchExternalUrl(
+    BuildContext context,
+    String url,
+  ) async {
+    final uri = Uri.parse(url);
+    final launched = await launchUrl(
+      uri,
+      mode: LaunchMode.externalApplication,
+    );
+
+    if (!launched) {
+      debugPrint('Could not launch $url');
+      ScaffoldMessenger.of(context).showSnackBar(
+        SnackBar(content: Text('Could not open link: $url')),
+      );
+    }
+  }
   // Menu button widget
   static PopupMenuButton<String> buildMenuButton(BuildContext context) {
     return PopupMenuButton<String>(
       icon: const Icon(Icons.menu),
       onSelected: (value) => handleMenuSelection(context, value),
       itemBuilder: (BuildContext context) => <PopupMenuEntry<String>>[
         const PopupMenuItem<String>(
           value: 'about',
           child: ListTile(
             leading: Icon(Icons.info),
             title: Text('About the App'),
           ),
         ),
         const PopupMenuItem<String>(
           value: 'concept',
           child: ListTile(
             leading: Icon(Icons.lightbulb),
             title: Text('Tao of the Day Concept'),
           ),
         ),
         const PopupMenuItem<String>(
           value: 'subscribe',
           child: ListTile(
             leading: Icon(Icons.star),
             title: Text('Go Premium'),
@@ -64,922 +128,883 @@ class MenuDialogs {
             leading: Icon(Icons.description),
             title: Text('Terms of Service'),
           ),
         ),
         const PopupMenuItem<String>(
           value: 'data',
           child: ListTile(
             leading: Icon(Icons.data_usage),
             title: Text('Data Transparency'),
           ),
         ),
         const PopupMenuItem<String>(
           value: 'legal',
           child: ListTile(
             leading: Icon(Icons.gavel),
             title: Text('Legal & Disclaimers'),
           ),
         ),
       ],
     );
   }
 
   // Menu selection handler
   static void handleMenuSelection(BuildContext context, String value) {
     switch (value) {
-        case 'about':
+      case 'about':
         showAboutDialog(context);
         break;
       case 'concept':
         showConceptDialog(context);
         break;
       case 'subscribe':
         Navigator.push(
           context,
           MaterialPageRoute(builder: (context) => const SubscriptionPage()),
         );
         break;
       case 'noomvibe':
         showNoomVibeDialog(context);
         break;
       case 'translation':
         showTranslationDialog(context);
         break;
       case 'privacy':
         showPrivacyPolicyDialog(context);
         break;
       case 'terms':
         showTermsOfServiceDialog(context);
         break;
       case 'data':
         showDataTransparencyDialog(context);
         break;
       case 'legal':
         showLegalDialog(context);
         break;
     }
   }
 
   static void showAboutDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
+    final parentContext = context;
+
     showDialog(
-      context: context,
-      builder: (BuildContext context) {
+      context: parentContext,
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'About This App',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'Created by MartinJon',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'This app was created to make the ancient wisdom of the Tao Te Ching accessible for daily contemplation and modern living. Each day, you can explore one of the 81 chapters and reflect on its timeless teachings.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'The daily selection limitation is intentional - I want to encourages deep reflection on a single teaching rather than superficial reading of many. I hope you take the time to explore the conversations around the chapter you selected',
                   style: TextStyle(
                     fontStyle: FontStyle.italic,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'The Way of Random Selection:',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'Your random Tao is immediately chosen for you, without option to re-roll. This practice teaches acceptance - embracing whatever chapter appears as exactly what you need to contemplate today.',
                   style: TextStyle(
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                     fontStyle: FontStyle.italic,
                   ),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'Tao Journey Feature:',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'Track your progress through the 81 Tao chapters with the Tao Journey feature. '
                       'Toggle "Track your selections" to see which chapters you\'ve explored and focus on new ones. '
                       'Your journey is saved locally on your device.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-                Container(
-                  padding: const EdgeInsets.all(8),
-                  decoration: BoxDecoration(
-                    color: (isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)).withOpacity(0.1),
-                    borderRadius: BorderRadius.circular(6),
-                  ),
-                  child: GestureDetector(  // ‚Üê Wrap with GestureDetector
-                    onTap: () {
-                      Navigator.pop(context); // Close about dialog
-                      _showDeveloperMenu(context); // Show developer menu
-                    },
-                  child: Row(
-                    mainAxisAlignment: MainAxisAlignment.center,
-                    children: [
-                      Icon(
-                        Icons.info_outline,
-                        size: 16,
-                        color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00),
-                      ),
-                      const SizedBox(width: 8),
-                      Text(
-                        'App Version: $appVersion', // ‚Üê Simple static version
-                        style: TextStyle(
-                          fontWeight: FontWeight.bold,
-                          color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00),
+                GestureDetector(
+                  behavior: HitTestBehavior.opaque,
+                  onTap: () {
+                    Navigator.of(dialogContext).pop();
+                    _showDeveloperMenu(parentContext);
+                  },
+                  child: Container(
+                    padding: const EdgeInsets.all(8),
+                    decoration: BoxDecoration(
+                      color: palette.primary.withOpacity(0.1),
+                      borderRadius: BorderRadius.circular(6),
+                    ),
+                    child: Row(
+                      mainAxisAlignment: MainAxisAlignment.center,
+                      children: [
+                        Icon(
+                          Icons.info_outline,
+                          size: 16,
+                          color: palette.primary,
                         ),
-                      ),
-                    ],
+                        const SizedBox(width: 8),
+                        FutureBuilder<String>(
+                          future: _appVersionFuture,
+                          builder: (context, snapshot) {
+                            final versionLabel =
+                                snapshot.hasData && (snapshot.data ?? '').isNotEmpty
+                                    ? snapshot.data!
+                                    : _fallbackAppVersion;
+                            return Text(
+                              'App Version: $versionLabel',
+                              style: TextStyle(
+                                fontWeight: FontWeight.bold,
+                                color: palette.primary,
+                              ),
+                            );
+                          },
+                        ),
+                      ],
+                    ),
                   ),
                 ),
-                ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
   static void showConceptDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
-
     showDialog(
       context: context,
-      builder: (BuildContext context) {
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'The Tao Concept',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'Why One Tao Per Day?',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 12),
                 Text(
                   '‚Ä¢ Deep Contemplation: Focusing on one chapter allows for meaningful reflection',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 Text(
                   '‚Ä¢ Practical Integration: Gives time to apply the teaching in daily life',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 Text(
                   '‚Ä¢ Ancient Practice: Traditionally, Tao teachings were contemplated slowly',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'How to Use This App:',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 12),
                 Text(
                   '1. Select your Tao for the day\n2. Read the text slowly\n3. Listen to the discussions\n4. Reflect throughout the day\n5. Return tomorrow for new wisdom',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
   static void showNoomVibeDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
-
     showDialog(
       context: context,
-      builder: (BuildContext context) {
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'Live Tao of the Day Show',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'Join me live on NoomVibe!',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'Experience the Tao of the Day through live discussions and community conversations. Click the link below to find me on the NoomVibe app where I host live Tao of the Day shows at 6am Central time Mon through Friday',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 12),
                 Text(
                   'Platform: NoomVibe',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 Text(
                   'Schedule: M-F 6a Central',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
                 GestureDetector(
                   onTap: () async {
-                    final Uri uri = Uri.parse("https://noomvibe.app/martinjon");
-                    if (!await launchUrl(uri)) {
-                      throw Exception('Could not launch URL');
-                    }
+                    await _launchExternalUrl(
+                      dialogContext,
+                      'https://noomvibe.app/martinjon',
+                    );
                   },
                   child: Text(
                     'üëâ Tap here to visit NoomVibe',
                     style: TextStyle(
-                      color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00),
+                      color: palette.primary,
                       fontWeight: FontWeight.bold,
                       decoration: TextDecoration.underline,
                     ),
                   ),
                 ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
   static void showTranslationDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
-
     showDialog(
       context: context,
-      builder: (BuildContext context) {
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'Get the Complete Translation',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'Deepen Your Practice',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'Get the printed version of my translation of the Tao te Ching.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
                 GestureDetector(
                   onTap: () async {
-                    final Uri uri = Uri.parse("https://www.martinjon.com/product-page/tao-te-ching");
-                    if (!await launchUrl(uri)) {
-                      throw Exception('Could not launch URL');
-                    }
+                    await _launchExternalUrl(
+                      dialogContext,
+                      'https://www.martinjon.com/product-page/tao-te-ching',
+                    );
                   },
                   child: Text(
                     'üìö Available in Paperback',
                     style: TextStyle(
-                      color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00),
+                      color: palette.primary,
                       fontWeight: FontWeight.bold,
                     ),
                   ),
                 ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
   static void showPrivacyPolicyDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
-
     showDialog(
       context: context,
-      builder: (BuildContext context) {
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'Privacy Policy',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'Last Updated: ${DateFormat('yyyy-MM-dd').format(DateTime.now())}',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 16),
-
                 GestureDetector(
                   onTap: () async {
-                    final Uri uri = Uri.parse("https://www.martinjon.com/tao-app-privacy");
-                    if (!await launchUrl(uri)) {
-                      throw Exception('Could not launch URL');
-                    }
+                    await _launchExternalUrl(
+                      dialogContext,
+                      'https://www.martinjon.com/tao-app-privacy',
+                    );
                   },
                   child: Container(
                     padding: const EdgeInsets.all(12),
                     decoration: BoxDecoration(
-                      color: (isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)).withOpacity(0.1),
+                      color: palette.primary.withOpacity(0.1),
                       borderRadius: BorderRadius.circular(8),
-                      border: Border.all(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+                      border: Border.all(color: palette.primary),
                     ),
                     child: Row(
                       children: [
-                        Icon(Icons.launch, size: 16, color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+                        Icon(Icons.launch, size: 16, color: palette.primary),
                         const SizedBox(width: 8),
                         Expanded(
                           child: Text(
                             'View Full Privacy Policy Online',
                             style: TextStyle(
-                              color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00),
+                              color: palette.primary,
                               fontWeight: FontWeight.bold,
                             ),
                           ),
                         ),
                       ],
                     ),
                   ),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Data Collection & Usage',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   '‚Ä¢ Daily Selection: We store your daily Tao selection locally on your device to enforce the "one Tao per day" feature\n'
                       '‚Ä¢ App Preferences: Theme preferences and settings are stored locally\n'
                       '‚Ä¢ No Personal Data: We do not collect, store, or transmit any personally identifiable information\n'
                       '‚Ä¢ No Analytics: We do not use analytics or tracking services\n'
                       '‚Ä¢ No Third-Party Sharing: We do not share any data with third parties',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Local Storage',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'This app uses local storage (SharedPreferences) to remember:\n'
                       '‚Ä¢ Your selected Tao number for the current day\n'
                       '‚Ä¢ The date of your last selection\n'
                       '‚Ä¢ Your theme preference (light/dark mode)',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'External Links',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'This app contains links to external websites (NoomVibe, MartinJon.com). '
                       'We are not responsible for the privacy practices of these external sites.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Contact',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'For privacy-related questions, contact: MartinJon@martinjon.com',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
   static void showTermsOfServiceDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
-
     showDialog(
       context: context,
-      builder: (BuildContext context) {
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'Terms of Service',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'Acceptance of Terms',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'By using Tao of the Day, you agree to these terms and conditions.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Educational Purpose',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'This app is provided for educational and contemplative purposes only. '
                       'The content is not intended as professional advice, medical guidance, or psychological counseling.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Intellectual Property',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   '‚Ä¢ Tao Te Ching text: Based on ancient public domain works with modern interpretation\n'
                       '‚Ä¢ Audio content: Original discussions created by MartinJon\n'
                       '‚Ä¢ App design and code: Copyright ¬© ${DateTime.now().year} MartinJon\n'
                       '‚Ä¢ All rights reserved for original content and app implementation',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'User Responsibilities',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   '‚Ä¢ Use the app as intended for personal contemplation\n'
                       '‚Ä¢ Respect the daily limitation feature\n'
                       '‚Ä¢ Do not attempt to reverse engineer or modify the app\n'
                       '‚Ä¢ Use audio content for personal educational purposes only',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Limitation of Liability',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'The creators are not responsible for individual interpretations or applications of the Tao teachings. '
                       'Users apply the wisdom at their own discretion and responsibility.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Changes to Terms',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'We reserve the right to modify these terms at any time. Continued use of the app constitutes acceptance of updated terms.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
   static void showDataTransparencyDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
-
     showDialog(
       context: context,
-      builder: (BuildContext context) {
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'Data Transparency',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'We believe in complete transparency about what data we handle:',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Container(
                   padding: const EdgeInsets.all(12),
                   decoration: BoxDecoration(
-                    color: (isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)).withOpacity(0.1),
+                    color: palette.primary.withOpacity(0.1),
                     borderRadius: BorderRadius.circular(8),
-                    border: Border.all(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+                    border: Border.all(color: palette.primary),
                   ),
                   child: Column(
                     crossAxisAlignment: CrossAxisAlignment.start,
                     children: [
                       Text(
                         'üì± Data We Store Locally:',
                         style: TextStyle(
                           fontWeight: FontWeight.bold,
-                          color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00),
+                          color: palette.primary,
                         ),
                       ),
                       const SizedBox(height: 8),
                       Text(
                         '‚Ä¢ selectedNumber: Your daily Tao choice (e.g., "42")\n'
                             '‚Ä¢ selectedNumberDate: Date of selection (e.g., "20241225")\n'
                             '‚Ä¢ selectedNumbers: Your Tao journey progress (e.g., "[1, 5, 42]")\n'
                             '‚Ä¢ filterUsedNumbers: Tao journey filter preference\n'
                             '‚Ä¢ Theme preference: Your light/dark mode choice',
-                        style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                        style: TextStyle(color: palette.body),
                       ),
                     ],
                   ),
                 ),
                 const SizedBox(height: 16),
-
                 Container(
                   padding: const EdgeInsets.all(12),
                   decoration: BoxDecoration(
                     color: Colors.green.withOpacity(0.1),
                     borderRadius: BorderRadius.circular(8),
                     border: Border.all(color: Colors.green),
                   ),
                   child: Column(
                     crossAxisAlignment: CrossAxisAlignment.start,
                     children: [
                       const Text(
                         '‚úÖ Data We NEVER Collect:',
                         style: TextStyle(
                           fontWeight: FontWeight.bold,
                           color: Colors.green,
                         ),
                       ),
                       const SizedBox(height: 8),
                       Text(
                         '‚Ä¢ Personal identification information\n'
                             '‚Ä¢ Email addresses or contact details\n'
                             '‚Ä¢ Location data or device identifiers\n'
                             '‚Ä¢ Usage analytics or behavior tracking\n'
                             '‚Ä¢ Payment or financial information',
-                        style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                        style: TextStyle(color: palette.body),
                       ),
                     ],
                   ),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'External Data Sources:',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   '‚Ä¢ Tao content: Loaded from Google Sheets (public CSV)\n'
                       '‚Ä¢ Audio files: Streamed from external hosting services\n'
                       '‚Ä¢ All external data is loaded in real-time, not stored permanently',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
-
                 Text(
                   'Your Privacy Matters',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'This app is designed to respect your privacy completely. '
                       'We minimize data collection to only what\'s necessary for core functionality.',
                   style: TextStyle(
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                     fontStyle: FontStyle.italic,
                   ),
                 ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
   static void showLegalDialog(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
-
     showDialog(
       context: context,
-      builder: (BuildContext context) {
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
         return AlertDialog(
-          backgroundColor: isDarkMode ? const Color(0xFF2A2A2A) : Colors.white,
+          backgroundColor: palette.background,
           title: Text(
             'Legal & Disclaimers',
-            style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
+            style: TextStyle(color: palette.primary),
           ),
           content: SingleChildScrollView(
             child: Column(
               crossAxisAlignment: CrossAxisAlignment.start,
               mainAxisSize: MainAxisSize.min,
               children: [
                 Text(
                   'Educational Purpose Only',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 12),
                 Text(
                   'This app is for educational and contemplative purposes only. The content is not intended as professional advice, medical guidance, or psychological counseling.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'Tao Te Ching Text:',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'The Tao Te Ching text used in this app is based on ancient public domain works with modern interpretation. Various translations and commentaries have been referenced to create this work. I do not read ancient Chinese.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'Personal Responsibility:',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'Users are encouraged to apply the teachings with wisdom and discretion in their personal lives. The creators are not responsible for individual interpretations or applications of the material.',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
                 const SizedBox(height: 16),
                 Text(
                   'Contact:',
                   style: TextStyle(
                     fontWeight: FontWeight.bold,
-                    color: isDarkMode ? Colors.white70 : Colors.black87,
+                    color: palette.body,
                   ),
                 ),
                 const SizedBox(height: 8),
                 Text(
                   'For questions or concerns, please contact MartinJon@martinjon.com',
-                  style: TextStyle(color: isDarkMode ? Colors.white70 : Colors.black87),
+                  style: TextStyle(color: palette.body),
                 ),
               ],
             ),
           ),
-          actions: [
-            TextButton(
-              onPressed: () => Navigator.pop(context),
-              child: const Text('Close'),
-            ),
-          ],
+          actions: _defaultActions(dialogContext),
         );
       },
     );
   }
 
-  // Helper method for launching URLs
-  //static Future<void> launchExternalUrl(String url) async {
-    //final Uri uri = Uri.parse(url);
-    //if (!await launchUrl(uri)) {
-      //throw Exception('Could not launch $url');
-    //}
-  //}
-// Add these methods to your MenuDialogs class:
-
   static void _showDeveloperMenu(BuildContext context) {
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
+    final parentContext = context;
 
     showDialog(
-      context: context,
-      builder: (context) => AlertDialog(
-        title: Text('Developer Options'),
-        content: Column(
-          mainAxisSize: MainAxisSize.min,
-          children: [
-            ListTile(
-              leading: Icon(Icons.delete, color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
-              title: Text('Reset Trial'),
-              onTap: () {
-                TrialService.resetTrial();
-                Navigator.pop(context);
-                ScaffoldMessenger.of(context).showSnackBar(
-                    SnackBar(content: Text('Trial reset'))
-                );
-              },
-            ),
-            ListTile(
-              leading: Icon(Icons.visibility, color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
-              title: Text('Check Subscription Status'),
-              onTap: () {
-                Navigator.pop(context);
-                _checkSubscriptionStatus(context);
-              },
-            ),
-            ListTile(
-              leading: Icon(Icons.shopping_cart, color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00)),
-              title: Text('Force Subscription Page'),
-              onTap: () {
-                Navigator.pop(context);
-                Navigator.push(
-                  context,
-                  MaterialPageRoute(builder: (context) => const SubscriptionPage()),
-                );
-              },
-            ),
-          ],
-        ),
-      ),
+      context: parentContext,
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
+        return AlertDialog(
+          backgroundColor: palette.background,
+          title: Text(
+            'Developer Options',
+            style: TextStyle(color: palette.primary),
+          ),
+          content: Column(
+            mainAxisSize: MainAxisSize.min,
+            children: [
+              ListTile(
+                leading: Icon(Icons.delete, color: palette.primary),
+                title: const Text('Reset Trial'),
+                onTap: () {
+                  TrialService.resetTrial();
+                  Navigator.of(dialogContext).pop();
+                  ScaffoldMessenger.of(parentContext).showSnackBar(
+                    const SnackBar(content: Text('Trial reset')),
+                  );
+                },
+              ),
+              ListTile(
+                leading: Icon(Icons.visibility, color: palette.primary),
+                title: const Text('Check Subscription Status'),
+                onTap: () {
+                  Navigator.of(dialogContext).pop();
+                  _checkSubscriptionStatus(parentContext);
+                },
+              ),
+              ListTile(
+                leading: Icon(Icons.shopping_cart, color: palette.primary),
+                title: const Text('Force Subscription Page'),
+                onTap: () {
+                  Navigator.of(dialogContext).pop();
+                  Navigator.push(
+                    parentContext,
+                    MaterialPageRoute(
+                      builder: (context) => const SubscriptionPage(),
+                    ),
+                  );
+                },
+              ),
+            ],
+          ),
+        );
+      },
     );
   }
 
   static void _checkSubscriptionStatus(BuildContext context) async {
     final subscriptionService = SubscriptionService();
     await subscriptionService.initialize();
-    final hasAccess = await subscriptionService.hasActiveSubscription();
-    final isSubscribed = await subscriptionService.hasActiveSubscription();
+    final hasSubscription = await subscriptionService.hasActiveSubscription();
     final inTrial = await TrialService.isTrialActive();
     final daysRemaining = await TrialService.getDaysRemaining();
-
-    final isDarkMode = Theme.of(context).brightness == Brightness.dark;
+    final hasAccess = hasSubscription || inTrial;
 
     showDialog(
       context: context,
-      builder: (context) => AlertDialog(
-        title: Text('Subscription Status', style: TextStyle(color: isDarkMode ? const Color(0xFFD45C33) : const Color(0xFF7E1A00))),
-        content: Column(
-          mainAxisSize: MainAxisSize.min,
-          crossAxisAlignment: CrossAxisAlignment.start,
-          children: [
-            Text('Has Access: $hasAccess'),
-            Text('Is Subscribed: $isSubscribed'),
-            Text('In Trial: $inTrial'),
-            Text('Days Remaining: $daysRemaining'),
-          ],
-        ),
-        actions: [
-          TextButton(
-            onPressed: () => Navigator.pop(context),
-            child: Text('Close'),
+      builder: (dialogContext) {
+        final palette = _MenuDialogPalette.from(dialogContext);
+
+        return AlertDialog(
+          backgroundColor: palette.background,
+          title: Text(
+            'Subscription Status',
+            style: TextStyle(color: palette.primary),
           ),
-        ],
-      ),
+          content: Column(
+            mainAxisSize: MainAxisSize.min,
+            crossAxisAlignment: CrossAxisAlignment.start,
+            children: [
+              Text('Has Access: $hasAccess', style: TextStyle(color: palette.body)),
+              Text('Is Subscribed: $hasSubscription', style: TextStyle(color: palette.body)),
+              Text('In Trial: $inTrial', style: TextStyle(color: palette.body)),
+              Text('Days Remaining: $daysRemaining', style: TextStyle(color: palette.body)),
+            ],
+          ),
+          actions: _defaultActions(dialogContext),
+        );
+      },
     );
   }
 
 }
\ No newline at end of file
